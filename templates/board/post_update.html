{% extends "layout/base.html" %}
{% load static %}

{% block title %}
  글 수정 - 뭐입지?
{% endblock title %}

{% block head %}
    {% include "layout/head.html" %}
{% endblock head %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/board.css' %}">
{% endblock extra_css %}

{% block navi %}
  {% include "layout/navbar.html" %}
{% endblock navi %}

{% block content %}
    <div class="container my-5">
        <h2 class="mb-4">글 수정</h2>
        <form method="post" id="post-form" enctype="multipart/form-data">
            {% csrf_token %}

            <div class="mb-3">
                <label for="category" class="form-label">카테고리</label>
                <select name="category" id="category" class="form-select" required>
                    <option value="일반" {% if post.category == "일반" %}selected{% endif %}>일반</option>
                    <option value="코디" {% if post.category == "코디" %}selected{% endif %}>코디</option>
                </select>
            </div>

            <div class="mb-3">
                <label for="title" class="form-label">제목</label>
                <input type="text" name="title" id="title" class="form-control" value="{{ post.title }}" required>
            </div>

            <div class="mb-4">
                <label for="content" class="form-label">내용</label>
                <textarea name="content" id="content" class="form-control" rows="8" required>{{ post.content }}</textarea>
            </div>

            <div id="image-preview-container" class="mt-3 d-flex flex-wrap gap-2">
                <!-- 기존 이미지 -->
                {% for image in images %}
                    <div class="position-relative" data-image-id="{{ image.id }}">
                    <img src="{{ image.image.url }}" class="rounded post-edit-image">
                    <button ... class="btn btn-danger btn-sm position-absolute top-0 end-0 image-remove-btn">X</button>
                    </div>
                {% endfor %}
            </div>

            <!-- 파일 업로드 input은 그대로 유지 -->
            <input type="file" name="images" id="image" class="form-control mt-3 mb-3" multiple>

            <input type="hidden" id="delete-images" name="delete_images" value="">

            <button type="submit" class="btn btn-primary">수정</button>
            <a href="{% url 'board:post_list' %}" class="btn btn-secondary">취소</a>
        </form>
    </div>
{% endblock content %}

{% block footer %}
  {% include "layout/footer.html" %}
{% endblock footer %}

{% block script %}
    <script src="{% static 'js/board/post_update.js' %}"></script>
{% endblock script %}
